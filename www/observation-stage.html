<!DOCTYPE HTML>
<html>
	<head>
		<title>Observe</title>
		<meta name="viewport" content="width=device-width, initial-scale=1"> 
		<link rel="stylesheet" href="http://code.jquery.com/mobile/1.1.1/jquery.mobile-1.1.1.min.css" />
		<script src="http://code.jquery.com/jquery-1.7.1.min.js"></script>
		<script src="http://code.jquery.com/mobile/1.1.1/jquery.mobile-1.1.1.min.js"></script>
		<script type="text/javascript" charset="utf-8" src="cordova-2.0.0.js"></script>
		<script type="text/javascript" charset="utf-8" src="mtsutils.js"></script>
	</head>
	<body> 
		<script type="text/javascript">
			
			var firstInterval = new Object();
			firstInterval.behaviors = new Array();
			firstInterval.events = new Object();
			firstInterval.events['VVE'] = 2;
			
			var session = new Object();
			session['intervals'] = new Array();
			var intervals = session['intervals'];
			
			
			intervals[0] = new Object();//interval();
			intervals[0] = firstInterval;
			//session.intervals[0].events = new Object();
			//session.intervals[0].events['VVE'] += 1;
			
			
			//to denote what interval we are on
			var current_interval = 0;
			
			//to hold our javascript interval object
			var intervalHandle;
			
			//to hold our javascript interval timer object
			var timerHandle;
			
			//the amount of seconds elapsed
			var seconds = 0;
			
			//the amount of minutes elapsed
			var minutes = 0;
			
			//$(document).delegate('#stage').live('pagebeforeshow', function(event) { 
			//	$.mobile.changePage('#start-interval-dialog', {transition: 'pop', role: 'dialog'});
		
			//});
			
			function startObservation() {
				//alert("!!!");
				intervalHandle = setInterval(_interval, 15000);
				timerHandle = setInterval(_timer, 1000);
				
				$("#start-observation-dialog").dialog('close');
				window.location.href="#";
			}
			
			function hideBehaviorDialog() {
				$("#interval-behaviors-dialog").dialog('close');
				
				//handle interval data here
				
			}
			
			function stopObservation() {
				clearInterval(intervalHandle);
				clearInterval(timerHandle);
				
				$.mobile.changePage('report.html');
			}
			
			function _interval() {
				$.mobile.changePage('#interval-behaviors-dialog', {transition: 'pop', role: 'dialog'});
				current_interval += 1;
				
				session.intervals[current_interval] = new Object();
				session.intervals[current_interval].behaviors = new Array();
				
			}
			
			function _timer() {
				//calculate elapsed time
				seconds += 1;
				//alert(seconds);
				var mins = 0;
				var secs = 0;
				var minsDisplay;
				var secsDisplay;
				
				mins = Math.floor(seconds/60);
				
				if(mins > 0) {
					minutes = mins;
					secs = seconds % 60;
				} else {
					secs = seconds % 60;	
				}
				
				//var mins_display = "";
				if(mins < 10) {
					minsDisplay = "0"+mins;
				} else {
					minsDisplay = mins;
				}
				
				//var secs_display = "";
				if(secs < 10) {
					secsDisplay = "0"+secs;
				} else {
					secsDisplay = secs;
				}
				
				
				
				var time_display = minsDisplay + ":"+secsDisplay;
		
				//display elapsed time
				$("#time").text(time_display);
			}
		</script>
		<div data-role="page" id="stage">
			<div data-role="header">
				<h1>MST+</h1>
			</div><!-- /header -->
			<div data-role="content">		
				<br/>
				<br/>
				<br/>
				<h1 id="time">00:00</h1>
				<br/>
				<br/>
				<div data-role="controlgroup" data-type="horizontal">
					<button>VVE</button>
					<button>SVF</button>
					<button>EXT</button>
					<button>PRO</button>
					<button>SM</button>
					<button>EI</button>
					<button>CS</button>
				</div>		
				<br />
				<br />
				<br />
				<button onclick=stopObservation()>DONE</button>
			</div><!-- /content -->
		</div><!-- /page -->

		<div data-role="dialog" id="start-interval-dialog">	
			<div data-role="header">
				<h1>Start Observation</h1>
			</div>	
			<div data-role="content">
				<button onclick=startObservation()>START OBSERVATION</button>
				<br />
				<br />
				<br />	
				
				<fieldset data-role="controlgroup" data-type="horizontal">
				
				<label for="MO">MO</label>
				<label for="GP">GP</label>
				<label for="NP">NP</label>
				<label for="PB">PB</label>
				<label for="PLC">PLC</label>
				<label for="FE">FE</label>
				<label for="ASB">ASB</label>
				<label for="ALB">ALB</label>
				<label for="TT">TT</label>
				<label for="ER">ER</label>
				<label for="RP">RP</label>
				<label for="PI">PI</label>
				<label for="MPS">MPS</label>
				
				<input type="checkbox" name="MO" id="MO" value="MO"  />
				<input type="checkbox" name="GP" id="GP" value="GP"  />
				<input type="checkbox" name="NP" id="NP" value="NP"  />
				<input type="checkbox" name="PB" id="PB" value="PB"  />
				<input type="checkbox" name="PLC" id="PLC" value="PlC"  />
				<input type="checkbox" name="FE" id="FE" value="FE"  />
				<input type="checkbox" name="ASB" id="ASB" value="ASB"  />
				<input type="checkbox" name="ALB" id="ALB" value="ALB"  />
				<input type="checkbox" name="TT" id="TT" value="TT"  />
				<input type="checkbox" name="ER" id="ER" value="ER"  />
				<input type="checkbox" name="RP" id="RP" value="RP"  />
				<input type="checkbox" name="PI" id="PI" value="PI"  />
				<input type="checkbox" name="MPS" id="MPS" value="MPS"  />
			</fieldset>
				
			</div>
		</div>

		<div data-role="page" id="interval-behaviors-dialog">
			<div data-role="header">
				<h1>Interval Behaviors</h1>
			</div>	
			<br />
			<br />
			<br />	
			<fieldset data-role="controlgroup" data-type="horizontal">
				
				<label for="MO">MO</label>
				<label for="GP">GP</label>
				<label for="NP">NP</label>
				<label for="PB">PB</label>
				<label for="PLC">PLC</label>
				<label for="FE">FE</label>
				<label for="ASB">ASB</label>
				<label for="ALB">ALB</label>
				<label for="TT">TT</label>
				<label for="ER">ER</label>
				<label for="RP">RP</label>
				<label for="PI">PI</label>
				<label for="MPS">MPS</label>
				
				<input type="checkbox" name="MO" id="MO" value="MO"  />
				<input type="checkbox" name="GP" id="GP" value="GP"  />
				<input type="checkbox" name="NP" id="NP" value="NP"  />
				<input type="checkbox" name="PB" id="PB" value="PB"  />
				<input type="checkbox" name="PLC" id="PLC" value="PlC"  />
				<input type="checkbox" name="FE" id="FE" value="FE"  />
				<input type="checkbox" name="ASB" id="ASB" value="ASB"  />
				<input type="checkbox" name="ALB" id="ALB" value="ALB"  />
				<input type="checkbox" name="TT" id="TT" value="TT"  />
				<input type="checkbox" name="ER" id="ER" value="ER"  />
				<input type="checkbox" name="RP" id="RP" value="RP"  />
				<input type="checkbox" name="PI" id="PI" value="PI"  />
				<input type="checkbox" name="MPS" id="MPS" value="MPS"  />
			</fieldset>
			
			<button onclick=hideBehaviorDialog()>OK</button>
		</div>
	

	
	</body>
</html>